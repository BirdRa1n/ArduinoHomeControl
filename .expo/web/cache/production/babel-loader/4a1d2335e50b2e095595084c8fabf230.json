{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import $icz4I$react,{useState as $icz4I$useState,useImperativeHandle as $icz4I$useImperativeHandle,Fragment as $icz4I$Fragment}from\"react\";import $icz4I$reactdom from\"react-dom\";import{VisuallyHidden as $icz4I$VisuallyHidden}from\"@react-aria/visually-hidden\";function $parcel$export(e,n,v,s){Object.defineProperty(e,n,{get:v,set:s,enumerable:true,configurable:true});}var $9694eec57086f168$exports={};$parcel$export($9694eec57086f168$exports,\"announce\",function(){return $9694eec57086f168$export$a9b970dcc4ae71a9;});$parcel$export($9694eec57086f168$exports,\"clearAnnouncer\",function(){return $9694eec57086f168$export$d10ae4f68404609a;});$parcel$export($9694eec57086f168$exports,\"destroyAnnouncer\",function(){return $9694eec57086f168$export$d8686216b8b81b2f;});var $9694eec57086f168$var$LIVEREGION_TIMEOUT_DELAY=7000;var $9694eec57086f168$var$liveRegionAnnouncer=$icz4I$react.createRef();var $9694eec57086f168$var$node=null;var $9694eec57086f168$var$messageId=0;function $9694eec57086f168$export$a9b970dcc4ae71a9(message){var assertiveness=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'assertive';var timeout=arguments.length>2&&arguments[2]!==undefined?arguments[2]:$9694eec57086f168$var$LIVEREGION_TIMEOUT_DELAY;$9694eec57086f168$var$ensureInstance(function(announcer){return announcer.announce(message,assertiveness,timeout);});}function $9694eec57086f168$export$d10ae4f68404609a(assertiveness){$9694eec57086f168$var$ensureInstance(function(announcer){return announcer.clear(assertiveness);});}function $9694eec57086f168$export$d8686216b8b81b2f(){if($9694eec57086f168$var$liveRegionAnnouncer.current){$icz4I$reactdom.unmountComponentAtNode($9694eec57086f168$var$node);document.body.removeChild($9694eec57086f168$var$node);$9694eec57086f168$var$node=null;}}function $9694eec57086f168$var$ensureInstance(callback){if(!$9694eec57086f168$var$liveRegionAnnouncer.current){$9694eec57086f168$var$node=document.createElement('div');$9694eec57086f168$var$node.dataset.liveAnnouncer='true';document.body.prepend($9694eec57086f168$var$node);$icz4I$reactdom.render($icz4I$react.createElement($9694eec57086f168$var$LiveRegionAnnouncer,{ref:$9694eec57086f168$var$liveRegionAnnouncer}),$9694eec57086f168$var$node,function(){return callback($9694eec57086f168$var$liveRegionAnnouncer.current);});}else callback($9694eec57086f168$var$liveRegionAnnouncer.current);}var $9694eec57086f168$var$LiveRegionAnnouncer=$icz4I$react.forwardRef(function(_,ref){var _$icz4I$useState=$icz4I$useState([]),_$icz4I$useState2=_slicedToArray(_$icz4I$useState,2),assertiveMessages=_$icz4I$useState2[0],setAssertiveMessages=_$icz4I$useState2[1];var _$icz4I$useState3=$icz4I$useState([]),_$icz4I$useState4=_slicedToArray(_$icz4I$useState3,2),politeMessages=_$icz4I$useState4[0],setPoliteMessages=_$icz4I$useState4[1];var clear=function clear(assertiveness){if(!assertiveness||assertiveness==='assertive')setAssertiveMessages([]);if(!assertiveness||assertiveness==='polite')setPoliteMessages([]);};var $9694eec57086f168$export$a9b970dcc4ae71a9=function $9694eec57086f168$export$a9b970dcc4ae71a9(message1){var assertiveness=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'assertive';var timeout=arguments.length>2&&arguments[2]!==undefined?arguments[2]:$9694eec57086f168$var$LIVEREGION_TIMEOUT_DELAY;var id=$9694eec57086f168$var$messageId++;if(assertiveness==='assertive')setAssertiveMessages(function(messages){return[].concat(_toConsumableArray(messages),[{id:id,text:message1}]);});else setPoliteMessages(function(messages){return[].concat(_toConsumableArray(messages),[{id:id,text:message1}]);});if(message1!=='')setTimeout(function(){if(assertiveness==='assertive')setAssertiveMessages(function(messages){return messages.filter(function(message){return message.id!==id;});});else setPoliteMessages(function(messages){return messages.filter(function(message){return message.id!==id;});});},timeout);};$icz4I$useImperativeHandle(ref,function(){return{announce:$9694eec57086f168$export$a9b970dcc4ae71a9,clear:clear};});return $icz4I$react.createElement($icz4I$Fragment,null,$icz4I$react.createElement($9694eec57086f168$var$MessageBlock,{\"aria-live\":\"assertive\"},assertiveMessages.map(function(message){return $icz4I$react.createElement(\"div\",{key:message.id},message.text);})),$icz4I$react.createElement($9694eec57086f168$var$MessageBlock,{\"aria-live\":\"polite\"},politeMessages.map(function(message){return $icz4I$react.createElement(\"div\",{key:message.id},message.text);})));});function $9694eec57086f168$var$MessageBlock(_ref){var children=_ref.children,ariaLive=_ref['aria-live'];return $icz4I$react.createElement($icz4I$VisuallyHidden,{role:\"log\",\"aria-live\":ariaLive,\"aria-relevant\":\"additions\"},children);}export{$9694eec57086f168$export$a9b970dcc4ae71a9 as announce,$9694eec57086f168$export$d10ae4f68404609a as clearAnnouncer,$9694eec57086f168$export$d8686216b8b81b2f as destroyAnnouncer};","map":{"version":3,"sources":["packages/@react-aria/live-announcer/src/LiveAnnouncer.tsx"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport React, {Fragment, ReactNode, RefObject, useImperativeHandle, useState} from 'react';\nimport ReactDOM from 'react-dom';\nimport {VisuallyHidden} from '@react-aria/visually-hidden';\n\ntype Assertiveness = 'assertive' | 'polite';\ninterface Announcer {\n  announce(message: string, assertiveness: Assertiveness, timeout: number): void,\n  clear(assertiveness: Assertiveness): void\n}\n\n/* Inspired by https://github.com/AlmeroSteyn/react-aria-live */\nconst LIVEREGION_TIMEOUT_DELAY = 7000;\n\nlet liveRegionAnnouncer = React.createRef<Announcer>();\nlet node: HTMLElement = null;\nlet messageId = 0;\n\n/**\n * Announces the message using screen reader technology.\n */\nexport function announce(\n  message: string,\n  assertiveness: Assertiveness = 'assertive',\n  timeout = LIVEREGION_TIMEOUT_DELAY\n) {\n  ensureInstance(announcer => announcer.announce(message, assertiveness, timeout));\n}\n\n/**\n * Stops all queued announcements.\n */\nexport function clearAnnouncer(assertiveness: Assertiveness) {\n  ensureInstance(announcer => announcer.clear(assertiveness));\n}\n\n/**\n * Removes the announcer from the DOM.\n */\nexport function destroyAnnouncer() {\n  if (liveRegionAnnouncer.current) {\n    ReactDOM.unmountComponentAtNode(node);\n    document.body.removeChild(node);\n    node = null;\n  }\n}\n\n/**\n * Ensures we only have one instance of the announcer so that we don't have elements competing.\n */\nfunction ensureInstance(callback: (announcer: Announcer) => void) {\n  if (!liveRegionAnnouncer.current) {\n    node = document.createElement('div');\n    node.dataset.liveAnnouncer = 'true';\n    document.body.prepend(node);\n    ReactDOM.render(\n      <LiveRegionAnnouncer ref={liveRegionAnnouncer} />,\n      node,\n      () => callback(liveRegionAnnouncer.current)\n    );\n  } else {\n    callback(liveRegionAnnouncer.current);\n  }\n}\n\nconst LiveRegionAnnouncer = React.forwardRef((_, ref: RefObject<Announcer>) => {\n  let [assertiveMessages, setAssertiveMessages] = useState([]);\n  let [politeMessages, setPoliteMessages] = useState([]);\n\n  let clear = (assertiveness: Assertiveness) => {\n    if (!assertiveness || assertiveness === 'assertive') {\n      setAssertiveMessages([]);\n    }\n\n    if (!assertiveness || assertiveness === 'polite') {\n      setPoliteMessages([]);\n    }\n  };\n\n  let announce = (message: string, assertiveness = 'assertive', timeout = LIVEREGION_TIMEOUT_DELAY) => {\n    let id = messageId++;\n\n    if (assertiveness === 'assertive') {\n      setAssertiveMessages(messages => [...messages, {id, text: message}]);\n    } else {\n      setPoliteMessages(messages => [...messages, {id, text: message}]);\n    }\n\n    if (message !== '') {\n      setTimeout(() => {\n        if (assertiveness === 'assertive') {\n          setAssertiveMessages(messages => messages.filter(message => message.id !== id));\n        } else {\n          setPoliteMessages(messages => messages.filter(message => message.id !== id));\n        }\n      }, timeout);\n    }\n  };\n\n  useImperativeHandle(ref, () => ({\n    announce,\n    clear\n  }));\n\n  return (\n    <Fragment>\n      <MessageBlock aria-live=\"assertive\">\n        {assertiveMessages.map(message => <div key={message.id}>{message.text}</div>)}\n      </MessageBlock>\n      <MessageBlock aria-live=\"polite\">\n        {politeMessages.map(message => <div key={message.id}>{message.text}</div>)}\n      </MessageBlock>\n    </Fragment>\n  );\n});\n\ninterface MessageBlockProps {\n   children: ReactNode,\n   'aria-live': Assertiveness\n }\n\nfunction MessageBlock({children, 'aria-live': ariaLive}: MessageBlockProps) {\n  return (\n    <VisuallyHidden\n      role=\"log\"\n      aria-live={ariaLive}\n      aria-relevant=\"additions\">\n      {children}\n    </VisuallyHidden>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}